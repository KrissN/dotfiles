#!/bin/zsh

export WORKON_HOME=~/venv
export PROJECT_HOME=~/devel
export VIRTUAL_ENV_DISABLE_PROMPT=1

# ensure that we don't source virtualenvwrapper more than once
if [[ -z $VIRTUALENVWRAPPER_PROJECT_FILENAME ]]; then
    source /usr/bin/virtualenvwrapper.sh
fi

newvirtualenv() {
    if [[ -z $1 ]]; then
        base=$(pwd)
    else
        base=$1
    fi
    name=$(basename $base)
    args="-a $base"
    if [[ -e $base/requirements.txt ]]; then
        args="$args -r $base/requirements.txt"
    elif [[ -e $base/requirements.pip ]]; then
        args="$args -r $base/requirements.pip"
    fi

    mkvirtualenv ${=args} --system-site-packages $name
}

get_venv_prompt_info() {
    if [[ -n $VIRTUAL_ENV ]]; then
        echo "$(basename $VIRTUAL_ENV):"
    fi
}
